 # restaurant
 ## Модуль Заказы (Order)
 
 ### Назначение
 
 Модуль Заказы предназначен для работы с заказами, сформированными 
 из блюд меню. Заказ состоит из основной части, характеризующей заказ, и переменной части,
 состоящей из списка блюд меню. Заказы и списки блюд хранятся в базе данных (БД) в отдельных таблицах.
 Модуль позволяет:
  * добавлять, удалять, обновлять, просматривать заказы
  * добавлять блюда в заказ
  * менять статус заказа
  * получать информацию о заказах 
  
 ### Структура реализации
 
 Модуль Заказы реализует паттерн ***MVC***, когда бизнес модель связана со стороной пользователя через 
 [**Controller**](#сontroller). ***Spring framework*** обеспечивает связь всех компонентов модуля между собой.<br/>
 Основой бизнес модели являются классы [**Order (Заказы)**](#order) и [**OrderItem (Список блюд)**](#orderItem).
 Класс [**Order (Заказы)**](#order) отображен в БД таблицей **orders**. 
 Класс [**OrderItem (Список блюд)**](#orderItem) отображен в БД таблицей **order_items**.
 Классы связанны между собой односторонней связью отношением ОдинКоМногим.<br/>
 Cлой [**DAO**](#dao) на уровне ***Hibernate*** обеспечивает взаимодействие этих классов с БД через интерфейс **OrderDao**.<br/>
 Cлой [**Service**](#service) обеспечивает связь [**DAO**](#dao) с [**Controller**](#сontroller) через интерфейс **OrderService**.<br/> 
 [**Controller**](#сontroller) работает с [**REST запросами**](#rest-запросы), которые приходят от пользователя. 
 На уровне контроллера определяется семантика запросов. Контроллер по адресу запроса определяет, что делать с поступившими данными.
 Данные для обработки берутся из параметров адреса запроса и из тела запроса.
 Данные через [**Service**](#service) передаются в [**DAO**](#dao), где обрабатываются при взаимодействии с БД.
  Результат в обратном порядке из [**DAO**](#dao) через [**Service**](#service) возвращается в контроллер и поступет в тело ответа.
  Ответ передается пользователю.
 
 ![](https://image.prntscr.com/image/lOY9wxJYSVWdqcLHi48SlA.png)
 
 ### Структура данных
 <a name="order"></a>
 #### Order (Заказы)
 1. **id** — уникальный идентификаионный номер заказа (первичный ключ)   
 2. **date** — дата и время заказа  
 3. **date_ready** — дата и время выполнения заказа
 3. **customer character** — заказчик
 4. **tableNumber** — номер столика
 5. **status** — статус заказа 
 6. **comment** — комментарий к заказа
 7. **items** — список блюд заказа
 
 <a name="orderItem"></a>
 #### OrderItem (Список блюд)
 
 1. **id** — идентификатор (первичный ключ)    
 2. **name** — наименование блюда   
 3. **amount** — количество блюд
 
 <a name="dao"></a>
 ### DAO
 ![](https://image.prntscr.com/image/luOhgmZrTheRMAIP0ymxqA.png)
 
 <a name="service"></a>
 ### Service
 ![](https://image.prntscr.com/image/RpFMn-P0ROyPBSjUgVAE4w.png)
 
 <a name="сontroller"></a>
 ### Controller
 
 ### REST запросы
 Пользователь обращается к модулю на основании REST запросов с корнем ```/order```
 
 1. Добавить заказ.  
     
    ```/add```
    
     Post метод. Производится добавление данных о заказе в БД. Данные о заказе расположены в теле запроса.
     В теле ответа возвращается заказ, который добавили.
     
    
 2. Обновить заказ.
      
    ```/update```
    
     Post метод. Производится обновление существующего заказа в БД. Обновленные данные расположены в теле запроса.
     В теле ответа возвращается заказ, который обновили.
    
 3. Просмотреть заказ по указанному номеру заказа: 
  
    ```/get/{id}```
    
     Get метод. В адресе запроса передается номер заказ {id}. Тело запроса пусто. В тело ответа
     передаем данные о заказе. Если заказ с номером {id} не найден, то возвращается пустой ответ. 
  
 4. Удалить заказ по указанному номеру заказа:  
  
    ```/delete/{id}```
    
    Delete метод. В адресе запроса указаваем его номером {id} для удаления из базы данных. 
    Тело запроса пусто. В тело ответа передаем данные об удаленном заказе.
  
 5. Получить список заказов, относящимуся к определенному столику. 
  
    ```/table/{table}```
    
    Get метод. В адресе запроса передается номер столика {table}. Тело запроса пусто. 
    В тело ответа передаем список заказов, относящимся к столику, номер которого  указан в адресе запросе.
    
 6. Получить список всех заказов. 
  
    ```/all```
    
    Get метод. Тело запроса пусто. В тело ответа передаем список имеющихся заказов из БД.
  
 7. Получить список заказов с определенным статусом. 
  
    ```/status/{status}```
    
    Get метод. В адресе запроса передается статус заказов {status}. Тело запроса пусто.
    В тело ответа передаем список заказов из БД со статусом, введенном в адресе запроса.
    Если указан несуществующий статус, возвращается пустой список.
   
 8. Получаем последний заказ для столика.
   
    ```/lastorder/{table}```
    
    Get метод. В адресе запроса передается номер столика {table}. Тело запроса пусто.
    В тело ответа передаем данные о последнем заказе для столика, указанного в адресе запросе.                                                            
 
 9. Добавить блюдо в заказ.
   
    ```/additem/{id}```
    
    Post метод. В адресе запроса передается номер заказа {id}. В теле запроса передаем данные о блюде, которое
    добавляем к заказу, номер которого указан в адресе запроса. В тело ответа передаем данные о заказе,
    в который добавили блюдо.
   
 10. Изменить состояние заказа. 
  
     ```/changestatus/{id}/{status}```
     
      Post метод. В адресе запроса передается номер заказа {id}, состояние которого меняет, и новое сосояние заказ {status}.
      В теле запроса передаем данные заказа. В тело ответа передаем заказ с обновленным статусом.
      Если введем несуществующий номер заказа, то возвращается пустой ответ. 
      Если введем несуществующий статус, то статус заказа не изменится.
      Если введем статус *готов*, то поле **date_ready** заказа заполняется текущими датой и временем.
      
 
